<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lightning Network Capacity</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@400;700;800&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: linear-gradient(165deg, #0a0a0e 0%, #0f0f16 40%, #12101a 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
  }

  .card {
    width: 100%;
    max-width: 820px;
    background: linear-gradient(180deg, rgba(247,147,26,0.03) 0%, rgba(10,10,14,0.9) 100%);
    border: 1px solid rgba(247, 147, 26, 0.12);
    border-radius: 16px;
    padding: 32px 28px 20px;
    box-shadow: 0 0 80px rgba(247, 147, 26, 0.05), inset 0 1px 0 rgba(247,147,26,0.08);
  }

  .header-badge {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 6px;
  }
  .header-badge .icon { font-size: 22px; filter: saturate(1.3); }
  .header-badge .label {
    font-size: 11px; letter-spacing: 3px; color: #f7931a;
    text-transform: uppercase; font-weight: 600;
  }

  h1 {
    font-size: 28px; font-weight: 800; color: #f0f0f0;
    margin: 4px 0 12px; letter-spacing: -0.5px;
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
  }

  .stats { display: flex; gap: 24px; flex-wrap: wrap; margin-bottom: 28px; }
  .stat-label { font-size: 11px; color: #555; letter-spacing: 1px; margin-bottom: 2px; }
  .stat-value { font-size: 22px; font-weight: 700; }
  .stat-value.orange { color: #f7931a; }
  .stat-value.green { color: #00d4aa; }

  .chart-wrap { width: 100%; height: 380px; position: relative; }

  .footer {
    margin-top: 16px; padding-top: 14px;
    border-top: 1px solid rgba(247, 147, 26, 0.08);
    display: flex; justify-content: space-between; align-items: center;
    font-size: 10px; color: #444; letter-spacing: 0.5px;
  }

  .section-label {
    font-size: 11px; letter-spacing: 2px; color: #555;
    margin: 24px 0 8px; font-weight: 600;
  }
  .section-label:first-of-type { margin-top: 0; }

  .chart-small { height: 240px; }
</style>
<script defer src="https://cloud.umami.is/script.js" data-website-id="ca1e711f-b25a-46d7-8416-61674921da65"></script>
</head>
<body>

<div class="card">
  <div class="header-badge">
    <span class="icon">⚡</span>
    <span class="label">Lightning Network</span>
  </div>
  <h1>Network Capacity</h1>

  <div class="stats">
    <div>
      <div class="stat-label">CAPACITY</div>
      <div class="stat-value orange" id="current"></div>
    </div>
    <div>
      <div class="stat-label">CHANGE</div>
      <div class="stat-value green" id="change"></div>
    </div>
    <div>
      <div class="stat-label">CHANGE %</div>
      <div class="stat-value green" id="changePct"></div>
    </div>
  </div>

  <div class="stats">
    <div>
      <div class="stat-label">NODES (TOTAL)</div>
      <div class="stat-value orange" id="totalNodes"></div>
    </div>
    <div>
      <div class="stat-label">NODES (ACTIVE)</div>
      <div class="stat-value green" id="activeNodes"></div>
    </div>
    <div>
      <div class="stat-label">CHANNELS</div>
      <div class="stat-value orange" id="channels"></div>
    </div>
  </div>

  <div class="section-label">CAPACITY</div>
  <div class="chart-wrap">
    <canvas id="chart"></canvas>
  </div>

  <div class="section-label">CHANNELS</div>
  <div class="chart-wrap chart-small">
    <canvas id="chartChannels"></canvas>
  </div>

  <div class="section-label">ACTIVE NODES</div>
  <div class="chart-wrap chart-small">
    <canvas id="chartNodes"></canvas>
  </div>

  <div class="footer">
    <span id="footerRange"></span>
    <span id="footerDate"></span>
  </div>
</div>

<script>
const rawData = [
  { timestamp: 1771036352, total_nodes: 17294, active_nodes: 6670, channels: 50516, capacity_sat: 515570537612 },
  { timestamp: 1771037038, total_nodes: 17297, active_nodes: 6676, channels: 50579, capacity_sat: 516223469991 },
  { timestamp: 1771037484, total_nodes: 17297, active_nodes: 6676, channels: 50580, capacity_sat: 516273469991 },
  { timestamp: 1771040445, total_nodes: 17298, active_nodes: 6678, channels: 50584, capacity_sat: 516335188246 },
  { timestamp: 1771066804, total_nodes: 17297, active_nodes: 6680, channels: 50602, capacity_sat: 516763665704 },
  { timestamp: 1771073793, total_nodes: 17301, active_nodes: 6682, channels: 50615, capacity_sat: 516735512214 },
  { timestamp: 1771075796, total_nodes: 17300, active_nodes: 6682, channels: 50625, capacity_sat: 516925136955 },
  { timestamp: 1771089179, total_nodes: 17302, active_nodes: 6685, channels: 50633, capacity_sat: 517517229092 },
  { timestamp: 1771097322, total_nodes: 17302, active_nodes: 6687, channels: 50635, capacity_sat: 517951713637 },
];

const data = rawData.map(d => ({
  time: new Date(d.timestamp * 1000).toLocaleTimeString('pl-PL', { hour:'2-digit', minute:'2-digit' }),
  btc: d.capacity_sat / 1e8,
  sats: d.capacity_sat,
  total_nodes: d.total_nodes,
  active_nodes: d.active_nodes,
  channels: d.channels,
}));

const btcValues = data.map(d => d.btc);
const minBtc = Math.min(...btcValues);
const maxBtc = Math.max(...btcValues);
const lastBtc = data[data.length - 1].btc;
const firstBtc = data[0].btc;
const changeBtc = (lastBtc - firstBtc).toFixed(2);
const changePctVal = (((lastBtc - firstBtc) / firstBtc) * 100).toFixed(4);
const last = data[data.length - 1];

document.getElementById('current').textContent = '₿ ' + lastBtc.toFixed(2);
document.getElementById('change').textContent = '+' + changeBtc + ' BTC';
document.getElementById('changePct').textContent = '+' + changePctVal + '%';
document.getElementById('totalNodes').textContent = last.total_nodes.toLocaleString('pl-PL');
document.getElementById('activeNodes').textContent = last.active_nodes.toLocaleString('pl-PL');
document.getElementById('channels').textContent = last.channels.toLocaleString('pl-PL');
document.getElementById('footerDate').innerHTML =
  new Date(rawData[0].timestamp * 1000).toLocaleDateString('pl-PL') + ' ⚡ LIVE';

// Y-axis: fit data with comfortable padding
const dataRange = maxBtc - minBtc;
const padding = Math.max(dataRange * 0.5, 0.5);
const yMin = Math.floor(minBtc - padding);
const yMax = Math.ceil(maxBtc + padding);

document.getElementById('footerRange').textContent =
  'Y-RANGE: ₿' + yMin.toLocaleString('pl-PL') + ' – ₿' + yMax.toLocaleString('pl-PL');

const ctx = document.getElementById('chart').getContext('2d');

const gradient = ctx.createLinearGradient(0, 0, 0, 380);
gradient.addColorStop(0, 'rgba(247, 147, 26, 0.35)');
gradient.addColorStop(0.5, 'rgba(247, 147, 26, 0.08)');
gradient.addColorStop(1, 'rgba(247, 147, 26, 0)');

new Chart(ctx, {
  type: 'line',
  data: {
    labels: data.map(d => d.time),
    datasets: [{
      data: btcValues,
      borderColor: '#f7931a',
      borderWidth: 2.5,
      backgroundColor: gradient,
      fill: true,
      tension: 0.35,
      pointRadius: 6,
      pointBackgroundColor: '#f7931a',
      pointBorderColor: '#0a0a0e',
      pointBorderWidth: 2,
      pointHoverRadius: 9,
      pointHoverBackgroundColor: '#f7931a',
      pointHoverBorderColor: 'rgba(247, 147, 26, 0.3)',
      pointHoverBorderWidth: 6,
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    layout: { padding: { left: 4, right: 16, top: 8, bottom: 4 } },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: 'rgba(10, 10, 14, 0.95)',
        borderColor: 'rgba(247, 147, 26, 0.25)',
        borderWidth: 1,
        cornerRadius: 8,
        padding: 12,
        titleFont: { family: "'JetBrains Mono', monospace", size: 11 },
        titleColor: '#888',
        bodyFont: { family: "'JetBrains Mono', monospace", size: 14, weight: 'bold' },
        bodyColor: '#f7931a',
        displayColors: false,
        callbacks: {
          title: (items) => items[0].label,
          label: (item) => {
            const d = data[item.dataIndex];
            return ['₿ ' + d.btc.toFixed(4), d.sats.toLocaleString('pl-PL') + ' sat'];
          }
        }
      }
    },
    scales: {
      x: {
        grid: { display: false },
        border: { color: 'rgba(247, 147, 26, 0.15)' },
        ticks: {
          color: '#777',
          font: { family: "'JetBrains Mono', monospace", size: 12, weight: '600' },
          padding: 10,
          maxRotation: 0,
        }
      },
      y: {
        min: yMin,
        max: yMax,
        grid: { color: 'rgba(247, 147, 26, 0.06)', drawBorder: false },
        border: { display: false },
        ticks: {
          color: '#666',
          font: { family: "'JetBrains Mono', monospace", size: 11 },
          callback: v => '₿' + v.toLocaleString('pl-PL'),
          padding: 8,
          stepSize: 1,
        }
      }
    },
    interaction: { intersect: false, mode: 'index' }
  }
});

// --- Channels chart ---
const channelValues = data.map(d => d.channels);
const chMin = Math.min(...channelValues);
const chMax = Math.max(...channelValues);
const chPad = Math.max((chMax - chMin) * 0.5, 10);

const ctxCh = document.getElementById('chartChannels').getContext('2d');
const gradCh = ctxCh.createLinearGradient(0, 0, 0, 240);
gradCh.addColorStop(0, 'rgba(0, 212, 170, 0.30)');
gradCh.addColorStop(1, 'rgba(0, 212, 170, 0)');

new Chart(ctxCh, {
  type: 'line',
  data: {
    labels: data.map(d => d.time),
    datasets: [{
      data: channelValues,
      borderColor: '#00d4aa',
      borderWidth: 2,
      backgroundColor: gradCh,
      fill: true,
      tension: 0.35,
      pointRadius: 5,
      pointBackgroundColor: '#00d4aa',
      pointBorderColor: '#0a0a0e',
      pointBorderWidth: 2,
      pointHoverRadius: 8,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    layout: { padding: { left: 4, right: 16, top: 8, bottom: 4 } },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: 'rgba(10, 10, 14, 0.95)',
        borderColor: 'rgba(0, 212, 170, 0.25)',
        borderWidth: 1, cornerRadius: 8, padding: 12,
        titleFont: { family: "'JetBrains Mono', monospace", size: 11 },
        titleColor: '#888',
        bodyFont: { family: "'JetBrains Mono', monospace", size: 14, weight: 'bold' },
        bodyColor: '#00d4aa',
        displayColors: false,
        callbacks: {
          label: (item) => item.raw.toLocaleString('pl-PL') + ' channels'
        }
      }
    },
    scales: {
      x: {
        grid: { display: false },
        border: { color: 'rgba(0, 212, 170, 0.15)' },
        ticks: { color: '#777', font: { family: "'JetBrains Mono', monospace", size: 11, weight: '600' }, padding: 10, maxRotation: 0 }
      },
      y: {
        min: Math.floor(chMin - chPad),
        max: Math.ceil(chMax + chPad),
        grid: { color: 'rgba(0, 212, 170, 0.06)', drawBorder: false },
        border: { display: false },
        ticks: { color: '#666', font: { family: "'JetBrains Mono', monospace", size: 11 }, padding: 8,
          callback: v => v.toLocaleString('pl-PL') }
      }
    },
    interaction: { intersect: false, mode: 'index' }
  }
});

// --- Active Nodes chart ---
const nodeValues = data.map(d => d.active_nodes);
const nMin = Math.min(...nodeValues);
const nMax = Math.max(...nodeValues);
const nPad = Math.max((nMax - nMin) * 0.5, 5);

const ctxN = document.getElementById('chartNodes').getContext('2d');
const gradN = ctxN.createLinearGradient(0, 0, 0, 240);
gradN.addColorStop(0, 'rgba(130, 120, 255, 0.30)');
gradN.addColorStop(1, 'rgba(130, 120, 255, 0)');

new Chart(ctxN, {
  type: 'line',
  data: {
    labels: data.map(d => d.time),
    datasets: [{
      data: nodeValues,
      borderColor: '#8278ff',
      borderWidth: 2,
      backgroundColor: gradN,
      fill: true,
      tension: 0.35,
      pointRadius: 5,
      pointBackgroundColor: '#8278ff',
      pointBorderColor: '#0a0a0e',
      pointBorderWidth: 2,
      pointHoverRadius: 8,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    layout: { padding: { left: 4, right: 16, top: 8, bottom: 4 } },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: 'rgba(10, 10, 14, 0.95)',
        borderColor: 'rgba(130, 120, 255, 0.25)',
        borderWidth: 1, cornerRadius: 8, padding: 12,
        titleFont: { family: "'JetBrains Mono', monospace", size: 11 },
        titleColor: '#888',
        bodyFont: { family: "'JetBrains Mono', monospace", size: 14, weight: 'bold' },
        bodyColor: '#8278ff',
        displayColors: false,
        callbacks: {
          label: (item) => item.raw.toLocaleString('pl-PL') + ' active nodes'
        }
      }
    },
    scales: {
      x: {
        grid: { display: false },
        border: { color: 'rgba(130, 120, 255, 0.15)' },
        ticks: { color: '#777', font: { family: "'JetBrains Mono', monospace", size: 11, weight: '600' }, padding: 10, maxRotation: 0 }
      },
      y: {
        min: Math.floor(nMin - nPad),
        max: Math.ceil(nMax + nPad),
        grid: { color: 'rgba(130, 120, 255, 0.06)', drawBorder: false },
        border: { display: false },
        ticks: { color: '#666', font: { family: "'JetBrains Mono', monospace", size: 11 }, padding: 8,
          callback: v => v.toLocaleString('pl-PL') }
      }
    },
    interaction: { intersect: false, mode: 'index' }
  }
});
</script>
</body>
</html>
